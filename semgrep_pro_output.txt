                    
                    
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 18 Code Findings ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                                             
  [36m[22m[24m  app/api/polymarket/intake/approve/route.ts[0m
     ‚ù± [1mjavascript.lang.security.audit.unsafe-formatstring.unsafe-formatstring[0m
          Detected string concatenation with a non-literal variable in
          a util.format / console.log function. If an attacker injects
          a format specifier in the string, it will forge the log     
          message. Try to use constant values for the format string.  
          Details: https://sg.run/7Y5R                                
                                                                      
           36‚îÜ console.log(`[LLM] Categorized "${title}" ->`,
               categories);                                  
    
    
          Taint comes from:
    
           36‚îÜ console.log(`[LLM] Categorized "${title}" ->`,
               categories);                                  
    
    
                This is how taint reaches the sink:
    
           36‚îÜ console.log(`[LLM] Categorized "${title}" ->`,
               categories);                                  
    
    
            ‚ãÆ‚îÜ----------------------------------------
          186‚îÜ console.warn(`[Polymarket] orderbook spread too    
               wide (${(spread * 100).toFixed(1)}% >              
               ${MAX_ALLOWED_SPREAD * 100}%), skipping`, { tokenId
               });                                                
    
    
          Taint comes from:
    
          158‚îÜ const url = `${POLYMARKET_CLOB_API_URL}/orderbook?t
               oken_id=${encodeURIComponent(tokenId)}`;           
    
    
          Taint flows through these intermediate variables:
    
          158‚îÜ const url = `${POLYMARKET_CLOB_API_URL}/orderbook?t
               oken_id=${encodeURIComponent(tokenId)}`;           
    
          160‚îÜ const resp = await fetch(url, { cache: 'no-store'
               });                                              
    
          160‚îÜ const resp = await fetch(url, { cache: 'no-store'
               });                                              
    
          169‚îÜ const data = await resp.json();
    
          169‚îÜ const data = await resp.json();
    
          171‚îÜ const asks = Array.isArray(data?.asks) ? data.asks
               : Array.isArray(data?.data?.asks) ? data.data.asks
               : [];                                             
    
          173‚îÜ const bestAsk = asks.length ? Number(asks[0]?.price
               ?? asks[0]?.[0]) : undefined;                      
    
          184‚îÜ const spread = (bestAsk as number) - (bestBid as
               number);                                        
    
          186‚îÜ console.warn(`[Polymarket] orderbook spread too    
               wide (${(spread * 100).toFixed(1)}% >              
               ${MAX_ALLOWED_SPREAD * 100}%), skipping`, { tokenId
               });                                                
    
    
                This is how taint reaches the sink:
    
          186‚îÜ console.warn(`[Polymarket] orderbook spread too    
               wide (${(spread * 100).toFixed(1)}% >              
               ${MAX_ALLOWED_SPREAD * 100}%), skipping`, { tokenId
               });                                                
    
                                                              
  [36m[22m[24m  app/api/polymarket/resolution-sync/route.ts[0m
     ‚ù± [1mjavascript.lang.security.audit.unsafe-formatstring.unsafe-formatstring[0m
          Detected string concatenation with a non-literal variable in
          a util.format / console.log function. If an attacker injects
          a format specifier in the string, it will forge the log     
          message. Try to use constant values for the format string.  
          Details: https://sg.run/7Y5R                                
                                                                      
          406‚îÜ console.error(`[Resolution Sync] Failed to resolve
               ${event.title}:`, errorMsg);                      
    
    
          Taint comes from:
    
          406‚îÜ console.error(`[Resolution Sync] Failed to resolve
               ${event.title}:`, errorMsg);                      
    
    
                This is how taint reaches the sink:
    
          406‚îÜ console.error(`[Resolution Sync] Failed to resolve
               ${event.title}:`, errorMsg);                      
    
    
            ‚ãÆ‚îÜ----------------------------------------
          409‚îÜ console.error(`[Resolution Sync] Error processing
               mapping ${mapping.id}:`, mappingError);          
    
    
          Taint comes from:
    
          409‚îÜ console.error(`[Resolution Sync] Error processing
               mapping ${mapping.id}:`, mappingError);          
    
    
                This is how taint reaches the sink:
    
          409‚îÜ console.error(`[Resolution Sync] Error processing
               mapping ${mapping.id}:`, mappingError);          
    
                                                    
  [36m[22m[24m  app/api/sports/orderbook/route.ts[0m
     ‚ù± [1mjavascript.lang.security.audit.unsafe-formatstring.unsafe-formatstring[0m
          Detected string concatenation with a non-literal variable in
          a util.format / console.log function. If an attacker injects
          a format specifier in the string, it will forge the log     
          message. Try to use constant values for the format string.  
          Details: https://sg.run/7Y5R                                
                                                                      
           43‚îÜ console.error(`[Sports Orderbook] Failed to fetch
               orderbook for token ${tokenId}:`,                
               response.statusText);                            
    
    
          Taint comes from:
    
           43‚îÜ console.error(`[Sports Orderbook] Failed to fetch
               orderbook for token ${tokenId}:`,                
               response.statusText);                            
    
    
                This is how taint reaches the sink:
    
           43‚îÜ console.error(`[Sports Orderbook] Failed to fetch
               orderbook for token ${tokenId}:`,                
               response.statusText);                            
    
    
            ‚ãÆ‚îÜ----------------------------------------
           55‚îÜ console.error(`[Sports Orderbook] Error fetching
               orderbook for token ${tokenId}:`, error);       
    
    
          Taint comes from:
    
           55‚îÜ console.error(`[Sports Orderbook] Error fetching
               orderbook for token ${tokenId}:`, error);       
    
    
                This is how taint reaches the sink:
    
           55‚îÜ console.error(`[Sports Orderbook] Error fetching
               orderbook for token ${tokenId}:`, error);       
    
                                               
  [36m[22m[24m  app/api/sports/sync/route.ts[0m
     ‚ù± [1mjavascript.lang.security.audit.unsafe-formatstring.unsafe-formatstring[0m
          Detected string concatenation with a non-literal variable in
          a util.format / console.log function. If an attacker injects
          a format specifier in the string, it will forge the log     
          message. Try to use constant values for the format string.  
          Details: https://sg.run/7Y5R                                
                                                                      
          584‚îÜ console.log(`[Sports Sync] Completed in
               ${duration}ms:`, {                     
    
    
          Taint comes from:
    
          584‚îÜ console.log(`[Sports Sync] Completed in
               ${duration}ms:`, {                     
    
    
                This is how taint reaches the sink:
    
          584‚îÜ console.log(`[Sports Sync] Completed in
               ${duration}ms:`, {                     
    
                                                       
  [36m[22m[24m  app/api/sports/ws-publisher/route.ts[0m
     ‚ù± [1mjavascript.lang.security.audit.unsafe-formatstring.unsafe-formatstring[0m
          Detected string concatenation with a non-literal variable in
          a util.format / console.log function. If an attacker injects
          a format specifier in the string, it will forge the log     
          message. Try to use constant values for the format string.  
          Details: https://sg.run/7Y5R                                
                                                                      
           91‚îÜ console.error(`Error calculating odds for event
               ${event.id}:`, error);                         
    
    
          Taint comes from:
    
           91‚îÜ console.error(`Error calculating odds for event
               ${event.id}:`, error);                         
    
    
                This is how taint reaches the sink:
    
           91‚îÜ console.error(`Error calculating odds for event
               ${event.id}:`, error);                         
    
                                                     
  [36m[22m[24m  app/api/webhooks/deposits/route.ts[0m
     ‚ù± [1mjavascript.lang.security.audit.unsafe-formatstring.unsafe-formatstring[0m
          Detected string concatenation with a non-literal variable in
          a util.format / console.log function. If an attacker injects
          a format specifier in the string, it will forge the log     
          message. Try to use constant values for the format string.  
          Details: https://sg.run/7Y5R                                
                                                                      
          225‚îÜ console.error(`[Webhook] ‚ö†Ô∏è  Sweep failed for
               deposit ${depositId}:`, sweepError);        
    
    
          Taint comes from:
    
          225‚îÜ console.error(`[Webhook] ‚ö†Ô∏è  Sweep failed for
               deposit ${depositId}:`, sweepError);        
    
    
                This is how taint reaches the sink:
    
          225‚îÜ console.error(`[Webhook] ‚ö†Ô∏è  Sweep failed for
               deposit ${depositId}:`, sweepError);        
    
                                                                 
  [36m[22m[24m  app/components/admin/AdminPolymarketIntake.tsx[0m
     ‚ù± [1mjavascript.lang.security.audit.unsafe-formatstring.unsafe-formatstring[0m
          Detected string concatenation with a non-literal variable in
          a util.format / console.log function. If an attacker injects
          a format specifier in the string, it will forge the log     
          message. Try to use constant values for the format string.  
          Details: https://sg.run/7Y5R                                
                                                                      
          448‚îÜ console.error(`[Bulk Approve] Error for
               ${item.polymarketId}:`, err);          
    
    
          Taint comes from:
    
          448‚îÜ console.error(`[Bulk Approve] Error for
               ${item.polymarketId}:`, err);          
    
    
                This is how taint reaches the sink:
    
          448‚îÜ console.error(`[Bulk Approve] Error for
               ${item.polymarketId}:`, err);          
    
                                                        
  [36m[22m[24m  components/tour/CustomTourTooltip.tsx[0m
     ‚ù± [1mjavascript.lang.security.audit.unsafe-formatstring.unsafe-formatstring[0m
          Detected string concatenation with a non-literal variable in
          a util.format / console.log function. If an attacker injects
          a format specifier in the string, it will forge the log     
          message. Try to use constant values for the format string.  
          Details: https://sg.run/7Y5R                                
                                                                      
           54‚îÜ console.log(`‚è≥ Target not found (attempt
               ${retryCountRef.current}/10):`, target); 
    
    
          Taint comes from:
    
           53‚îÜ retryCountRef.current += 1;
    
    
          Taint flows through these intermediate variables:
    
           53‚îÜ retryCountRef.current += 1;
    
    
                This is how taint reaches the sink:
    
           54‚îÜ console.log(`‚è≥ Target not found (attempt
               ${retryCountRef.current}/10):`, target); 
    
                                       
  [36m[22m[24m  lib/hedge-manager.ts[0m
     ‚ù± [1mjavascript.lang.security.audit.unsafe-formatstring.unsafe-formatstring[0m
          Detected string concatenation with a non-literal variable in
          a util.format / console.log function. If an attacker injects
          a format specifier in the string, it will forge the log     
          message. Try to use constant values for the format string.  
          Details: https://sg.run/7Y5R                                
                                                                      
          651‚îÜ console.error(`[HedgeManager] Hedge attempt
               ${attempt}/${maxRetries} failed:`,         
               hedgeError.message);                       
    
    
          Taint comes from:
    
          651‚îÜ console.error(`[HedgeManager] Hedge attempt
               ${attempt}/${maxRetries} failed:`,         
               hedgeError.message);                       
    
    
                This is how taint reaches the sink:
    
          651‚îÜ console.error(`[HedgeManager] Hedge attempt
               ${attempt}/${maxRetries} failed:`,         
               hedgeError.message);                       
    
    
            ‚ãÆ‚îÜ----------------------------------------
          784‚îÜ console.error(`[HedgeManager] Chunk
               ${chunk.chunkIndex + 1} failed:`,  
               chunkError.message);               
    
    
          Taint comes from:
    
          784‚îÜ console.error(`[HedgeManager] Chunk
               ${chunk.chunkIndex + 1} failed:`,  
               chunkError.message);               
    
    
                This is how taint reaches the sink:
    
          784‚îÜ console.error(`[HedgeManager] Chunk
               ${chunk.chunkIndex + 1} failed:`,  
               chunkError.message);               
    
                             
  [36m[22m[24m  lib/llm.ts[0m
     ‚ù± [1mjavascript.lang.security.audit.unsafe-formatstring.unsafe-formatstring[0m
          Detected string concatenation with a non-literal variable in
          a util.format / console.log function. If an attacker injects
          a format specifier in the string, it will forge the log     
          message. Try to use constant values for the format string.  
          Details: https://sg.run/7Y5R                                
                                                                      
          119‚îÜ console.warn(`[LLM] API request failed:      
               ${res.status} ${res.statusText}`, errorText);
    
    
          Taint comes from:
    
          108‚îÜ 'Authorization': `Bearer ${apiKey}`,
    
    
          Taint flows through these intermediate variables:
    
          105‚îÜ const res = await fetch(OPENROUTER_API_URL, {
    
          105‚îÜ const res = await fetch(OPENROUTER_API_URL, {
    
    
                This is how taint reaches the sink:
    
          119‚îÜ console.warn(`[LLM] API request failed:      
               ${res.status} ${res.statusText}`, errorText);
    
                                       
  [36m[22m[24m  lib/pusher-server.ts[0m
     ‚ù± [1mjavascript.lang.security.audit.unsafe-formatstring.unsafe-formatstring[0m
          Detected string concatenation with a non-literal variable in
          a util.format / console.log function. If an attacker injects
          a format specifier in the string, it will forge the log     
          message. Try to use constant values for the format string.  
          Details: https://sg.run/7Y5R                                
                                                                      
           36‚îÜ console.error(`[Pusher] Error triggering user
               update for ${userId}:`, error);              
    
    
          Taint comes from:
    
           36‚îÜ console.error(`[Pusher] Error triggering user
               update for ${userId}:`, error);              
    
    
                This is how taint reaches the sink:
    
           36‚îÜ console.error(`[Pusher] Error triggering user
               update for ${userId}:`, error);              
    
                                     
  [36m[22m[24m  lib/redis-utils.ts[0m
     ‚ù± [1mjavascript.lang.security.audit.unsafe-formatstring.unsafe-formatstring[0m
          Detected string concatenation with a non-literal variable in
          a util.format / console.log function. If an attacker injects
          a format specifier in the string, it will forge the log     
          message. Try to use constant values for the format string.  
          Details: https://sg.run/7Y5R                                
                                                                      
           37‚îÜ console.error(`[Redis] Failed to publish to
               ${channel}:`, errorMsg);                   
    
    
          Taint comes from:
    
           37‚îÜ console.error(`[Redis] Failed to publish to
               ${channel}:`, errorMsg);                   
    
    
                This is how taint reaches the sink:
    
           37‚îÜ console.error(`[Redis] Failed to publish to
               ${channel}:`, errorMsg);                   
    
    
            ‚ãÆ‚îÜ----------------------------------------
           55‚îÜ console.error(`[Redis] Failed to delete key
               ${key}:`, error);                          
    
    
          Taint comes from:
    
           55‚îÜ console.error(`[Redis] Failed to delete key
               ${key}:`, error);                          
    
    
                This is how taint reaches the sink:
    
           55‚îÜ console.error(`[Redis] Failed to delete key
               ${key}:`, error);                          
    
                              
  [36m[22m[24m  lib/totp.ts[0m
    ‚ùØ‚ù± [1mjavascript.node-stdlib.cryptography.crypto-weak-algorithm.crypto-weak-[0m
  [1m     algorithm[0m                                                             
          The use of a weak cryptographic algorithm (e.g., SHA-1 or  
          MD5) has been identified. These algorithms are considered  
          insecure due to vulnerabilities that make them susceptible 
          to collision attacks, allowing attackers to compromise data
          integrity or security. Replace SHA-1 or MD5 with secure    
          hashing algorithms, such as: SHA-256 or higher (e.g.,      
          SHA-3).                                                    
          Details: https://sg.run/nJgp1                              
                                                                     
           48‚îÜ const hmac = crypto.createHmac('sha1', 
               secret).update(counterBuffer).digest();
    
    
          Taint comes from:
    
           48‚îÜ const hmac = crypto.createHmac('sha1', 
               secret).update(counterBuffer).digest();
    
    
                This is how taint reaches the sink:
    
           48‚îÜ const hmac = crypto.createHmac('sha1', 
               secret).update(counterBuffer).digest();
    
